<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="xiamengfan的个人博客"><meta name="keywords" content="JavaScript,Vue,Hexo,C++,algorithm"><meta name="author" content="xiamengfan"><meta name="copyright" content="xiamengfan"><title>xiamengfan的个人博客</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.9.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.9.1"><meta name="format-detection" content="telephone=no"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  hexoVersion: '6.3.0'
} </script><meta name="generator" content="Hexo 6.3.0"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar" data-display="false"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">xiamengfan</div><div class="author-info__description text-center">xiamengfan的个人博客</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">5</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">4</span></a></div></div></div><nav class="no-bg" id="nav"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">xiamengfan的个人博客</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right"></span></div><div id="site-info"><div id="site-title">xiamengfan的个人博客</div><div id="site-sub-title"></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2023/02/26/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8Hexo%E5%9C%A8Github%E4%B8%8A%E6%90%AD%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/">如何使用Hexo在Github上搭建个人博客</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2023-02-26</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E5%B7%A5%E5%85%B7/">工具</a></span><div class="content"><p>第一篇就顺手记录下自己的Github博客搭建的过程，这里以mac环境来做说明</p>
<h1 id="安装-Node-以及-Git"><a href="#安装-Node-以及-Git" class="headerlink" title="安装 Node 以及 Git"></a>安装 Node 以及 Git</h1><p>首先在电脑上安装好<a target="_blank" rel="noopener" href="https://nodejs.org/en/">Node.js</a>和<a target="_blank" rel="noopener" href="https://git-scm.com/">Git</a></p>
<p>查看 Node 和 npm（Node 自带的包管理工具，需要使用它来安装 Hexo）以及 Git 是否安装完成</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ node -v</span><br><span class="line">$ npm -v</span><br><span class="line">$ git version</span><br></pre></td></tr></table></figure>
<p>使用 npm 安装 Hexo</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ sudo npm install -g hexo-cli</span><br><span class="line">安装完成后创建一个存放我们blog的文件夹，然后初始化一下</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> ~</span><br><span class="line">$ <span class="built_in">mkdir</span> myGitBlog</span><br><span class="line">$ <span class="built_in">cd</span> myGitBlog</span><br><span class="line">$ hexo init <span class="comment">#初始化博客目录</span></span><br><span class="line">$ hexo s    <span class="comment">#预览 </span></span><br></pre></td></tr></table></figure>
<p>接下来我们可以在 myGitBlog 的根目录找到我们这个博客项目的配置文件 _config.yml<br>可以配置一些我们博客的基本信息，诸如博客的网站标题、网站描述、作者、时间格式、网站地址（即我们即将部署的自己的github主页地址，比如 <a href="https://xiamengfan.github.io/">https://xiamengfan.github.io/</a> ）等等信息<br>更详细的安装以及配置请参阅<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/">Hexo官方文档</a></p>
<p>至此，我们已经可以在本地写博客了：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;我的第一篇博客&quot;</span>     <span class="comment">#生成在 myGitBlog/source/_post 目录下</span></span><br><span class="line">$ hexo g        <span class="comment">#生成静态网页</span></span><br><span class="line">$ hexo server   <span class="comment">#启动一个本地服务器</span></span><br></pre></td></tr></table></figure>

<p>接下来介绍如何将我们本地的博客项目部署到自己的Github主页上</p>
<h1 id="部署到-Github"><a href="#部署到-Github" class="headerlink" title="部署到 Github"></a>部署到 Github</h1><p>在你准备部署到Github上之前，请先注意一些事项（尤其是正用Github管理站点目录的用户）：</p>
<ul>
<li>当执行 hexo deploy（hexo d） 时，Hexo 会将 public 目录中的文件和目录推送至 _config.yml 中指定的远端仓库和分支中，并且<strong>完全覆盖</strong>该分支下的已有内容</li>
<li>由于 Hexo 的部署默认使用分支 master，所以如果你同时正在使用 Github 管理你的站点目录，你应当注意你的部署分支应当不同于写作分支</li>
<li>一个好的实践是将站点目录和 Pages 分别存放在两个不同的 Github 仓库中，可以有效避免相互覆盖</li>
<li>Hexo 在部署你的站点生成的文件时并不会更新你的站点目录。因此你应该手动提交并推送你的写作分支</li>
</ul>
<p>如果你已充分知晓以上注意事项或者第一次尝试使用Github管理自己的站点目录，那么我们就开始吧</p>
<h2 id="创建你的Github站点"><a href="#创建你的Github站点" class="headerlink" title="创建你的Github站点"></a>创建你的Github站点</h2><p>首先需要创建一个你的 Github 账户，并且创建一个特殊的 repository，这个 repository 的名字必须为 username.github.io (username 为你的 Github 用户名，比如我的就是 xiamengfan.github.io)<br>Github 官网对此的介绍为：Websites for you and your projects. 可以写一些静态页面展示给别人看，拿来写博客可以说是再合适不过了<br>别人只需要访问 username.github.io 就可以看见你的博客主页了，比如<a href="https://xiamengfan.github.io/">我的</a></p>
<h2 id="Git用户信息以及ssh配置"><a href="#Git用户信息以及ssh配置" class="headerlink" title="Git用户信息以及ssh配置"></a>Git用户信息以及ssh配置</h2><p>配置当前项目的 Git 用户信息<br>如果之前使用 –global 参数进行过全局配置，且无需更改用户信息则不用配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> ~/myGitBlog</span><br><span class="line">$ git config user.name <span class="string">&quot;username&quot;</span>          <span class="comment">#Git用户名</span></span><br><span class="line">$ git config user.email <span class="string">&quot;example@xxx.com&quot;</span>  <span class="comment">#Git登陆邮箱</span></span><br></pre></td></tr></table></figure>
<p>生成 ssh key<br>这里我原先已经有了一个用于公司项目的 ssh key，所以使用 -f 参数重命名生成了一个另外的 ssh key</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -t rsa -C <span class="string">&quot;email@gmail.com&quot;</span> -f ~/.ssh/id_rsa_myGit</span><br></pre></td></tr></table></figure>
<p>配置公钥<br>输出并拷贝 id_rsa_myGit.pub 信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cat</span> ~/.ssh/id_rsa.pub</span><br></pre></td></tr></table></figure>
<p>进入你的Github主页，右上角个人信息处，点击 settings, 然后左侧栏点击 SSH and GPG Keys，点击 New SSH key，将拷贝的公钥信息复制，title 可随意填写</p>
<p>配置私钥</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-add ~/.ssh/id_rsa_myGit</span><br></pre></td></tr></table></figure>
<p>如果执行 ssh-add 时提示”Could not open a connection to your authentication agent”，可以先执行命令:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-agent bash</span><br></pre></td></tr></table></figure>
<p>然后再重新运行ssh-add命令</p>
<p>修改配置文件<br>若本地 .ssh 目录下无 config 文件，那么创建：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> ~/.ssh</span><br><span class="line">$ <span class="built_in">touch</span> config</span><br></pre></td></tr></table></figure>
<p>在 config 文件中添加以下内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Host github.com</span><br><span class="line">    HostName github.com</span><br><span class="line">    PreferredAuthentications publickey</span><br><span class="line">    IdentityFile ～/.ssh/id_rsa_myGit</span><br><span class="line">    User username</span><br></pre></td></tr></table></figure>
<p>测试ssh key 是否配置成功</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -T git@github.com</span><br></pre></td></tr></table></figure>
<p>输出“Hi username! You’ve successfully authenticated, but GitHub does not provide shell access.” 则代表成功了</p>
<h2 id="Hexo部署配置"><a href="#Hexo部署配置" class="headerlink" title="Hexo部署配置"></a>Hexo部署配置</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> ~/myGitBlog</span><br><span class="line">$ sudo npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>
<p>然后修改根目录配置文件 _config.yml 中的 deploy 部分：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repo: git@github.com:username/username.github.io.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure>
<p>ok，大功告成，现在可以很方便地将Github作为你的博客部署站点了：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ hexo g                        <span class="comment">#生成静态网页</span></span><br><span class="line">$ hexo d                        <span class="comment">#部署到 github</span></span><br></pre></td></tr></table></figure>
<p>生成静态网页和部署可以简写为一条命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo g -d</span><br></pre></td></tr></table></figure>
<p>更多 hexo 命令可参阅<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/commands">官网</a></p>
<h1 id="安装博客主题"><a href="#安装博客主题" class="headerlink" title="安装博客主题"></a>安装博客主题</h1><p>Hexo 支持各种各样的<a target="_blank" rel="noopener" href="https://hexo.io/themes/">主题</a>配置，在Github上已经有很多非常好看的主题项目可以下载，不同主题的配置方式也略有不同，可以查看各自的项目说明进行安装配置<br>这里以我安装的 hexo-theme-melody 为例</p>
<p>首先确认自己安装的Hexo版本，5.0上下安装此主题方式不同</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ hexo -v</span><br><span class="line">首先进入自己博客的工作目录进行安装</span><br><span class="line">hexo版本 &gt;= 5.0</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm install hexo-theme-melody</span><br><span class="line">hexo版本 &lt; 5.0</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> -b master https://github.com/Molunerfinn/hexo-theme-melody themes/melody</span><br></pre></td></tr></table></figure>
<p>设置 _config.yml<br>首先确认是否安装了 pug 以及 stylus 的渲染器插件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm <span class="built_in">ls</span> --depth 0</span><br></pre></td></tr></table></figure>
<p>如果没有，请下载安装：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-renderer-pug hexo-renderer-stylus --save</span><br></pre></td></tr></table></figure>
<p>安装完成后在工作目录下找到 _config.yml 文件，找到theme这行修改为 theme: <strong>melody</strong></p>
<p>至此，主题已经配置完成，可以打开自己博客主页查看效果了，更多配置请参阅：<a target="_blank" rel="noopener" href="https://molunerfinn.com/hexo-theme-melody-doc/zh-Hans/quick-start.html">hexo-theme-melody官方文档</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/08/26/Vue3-x%E4%B8%AD%E5%93%8D%E5%BA%94%E6%80%A7%E5%8E%9F%E7%90%86%E7%9A%84demo%E5%AE%9E%E7%8E%B0/">Vue3.x中响应性原理的demo实现</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-08-26</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Vue/">Vue</a></span><div class="content"><h1 id="响应性原理说明"><a href="#响应性原理说明" class="headerlink" title="响应性原理说明"></a>响应性原理说明</h1><p>这里直接引用<a target="_blank" rel="noopener" href="https://v3.cn.vuejs.org/guide/reactivity.html">官方文档上的注解</a></p>
<ol>
<li>当一个值被读取时进行追踪：proxy 的 get 处理函数中 track 函数记录了该 property 和当前副作用(effect)</li>
<li>当某个值改变时进行检测：在 proxy 上调用 set 处理函数</li>
<li>重新运行代码来读取原始值：trigger 函数查找哪些副作用依赖于该 property 并执行它们</li>
</ol>
<h1 id="demo实现"><a href="#demo实现" class="headerlink" title="demo实现"></a>demo实现</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> stack = [];</span><br><span class="line"><span class="keyword">const</span> map = <span class="keyword">new</span> <span class="title class_">WeakMap</span>(); <span class="comment">// 对键名对象弱引用，内存自动释放避免泄漏</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">createEffect</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">    stack.<span class="title function_">push</span>(fn);</span><br><span class="line">    <span class="title function_">fn</span>();</span><br><span class="line">    stack.<span class="title function_">pop</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">track</span>(<span class="params">target, prop</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> effect = stack[stack.<span class="property">length</span> - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span> (!effect) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> propMap = map.<span class="title function_">get</span>(target);</span><br><span class="line">    <span class="keyword">if</span> (!propMap) &#123;</span><br><span class="line">        map.<span class="title function_">set</span>(target, propMap = <span class="keyword">new</span> <span class="title class_">Map</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> effects = propMap.<span class="title function_">get</span>(prop);</span><br><span class="line">    <span class="keyword">if</span> (!effects) &#123;</span><br><span class="line">        propMap.<span class="title function_">set</span>(prop, effects = <span class="keyword">new</span> <span class="title class_">Set</span>());</span><br><span class="line">    &#125;</span><br><span class="line">    effects.<span class="title function_">add</span>(effect);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">trigger</span>(<span class="params">target, prop</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> propMap = map.<span class="title function_">get</span>(target);</span><br><span class="line">    <span class="keyword">if</span> (propMap) &#123;</span><br><span class="line">        <span class="keyword">const</span> effects = propMap.<span class="title function_">get</span>(prop);</span><br><span class="line">        <span class="keyword">if</span> (effects) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> effect <span class="keyword">of</span> effects) &#123;</span><br><span class="line">                <span class="title function_">effect</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">reactive</span>(<span class="params">data</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Proxy</span>(data, &#123;</span><br><span class="line">        <span class="title function_">get</span>(<span class="params">target, prop, receiver</span>) &#123;</span><br><span class="line">            <span class="title function_">track</span>(receiver, prop);</span><br><span class="line">            <span class="keyword">return</span> <span class="title class_">Reflect</span>.<span class="title function_">get</span>(...<span class="variable language_">arguments</span>);</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        <span class="title function_">set</span>(<span class="params">target, prop, value, receiver</span>) &#123;</span><br><span class="line">            <span class="title class_">Reflect</span>.<span class="title function_">set</span>(...<span class="variable language_">arguments</span>);</span><br><span class="line">            <span class="title function_">trigger</span>(receiver, prop);</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ref</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">reactive</span>(&#123;</span><br><span class="line">        value</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">computed</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="title function_">ref</span>(<span class="literal">null</span>);</span><br><span class="line">    <span class="title function_">createEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        res.<span class="property">value</span> = <span class="title function_">fn</span>();</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> a = <span class="title function_">ref</span>(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">let</span> b = <span class="title function_">ref</span>(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> c, d;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> e = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`a is <span class="subst">$&#123;a.value&#125;</span>, b is <span class="subst">$&#123;b.value&#125;</span>`</span>;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> sum = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    c = a.<span class="property">value</span> + b.<span class="property">value</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> product = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    d = a.<span class="property">value</span> * b.<span class="property">value</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">createEffect</span>(sum);</span><br><span class="line"><span class="title function_">createEffect</span>(product);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;e.value&#125;</span>, c: <span class="subst">$&#123;c&#125;</span>, d: <span class="subst">$&#123;d&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line">a.<span class="property">value</span> = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;e.value&#125;</span>, c: <span class="subst">$&#123;c&#125;</span>, d: <span class="subst">$&#123;d&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line">b.<span class="property">value</span> = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;e.value&#125;</span>, c: <span class="subst">$&#123;c&#125;</span>, d: <span class="subst">$&#123;d&#125;</span>`</span>);</span><br></pre></td></tr></table></figure></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/07/19/macOS%E7%8E%AF%E5%A2%83%E4%B8%8B%E4%BD%BF%E7%94%A8VSCode%E7%BC%96%E8%AF%91%E5%B9%B6%E8%B0%83%E8%AF%95C/">macOS环境下使用VSCode编译并调试C++</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-07-19</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E5%B7%A5%E5%85%B7/">工具</a></span><div class="content"><p>通过配置tasks.json完成c++代码的自动编译任务，然后再通过配置launch.json对编译完的文件自动执行并调试。</p>
<p>配置tasks.json的过程很顺利，很快就可以看的项目根目录下编译生成了代码对应的out文件，但是调试过程确一直没法正常运行，<br>折腾半天才知道mac在更新到Catalina后不再支持lldb调试，还好有便捷的替代方案可以解决：通过安装CodeLLDB插件进行launch.json的配置。</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/106935263?utm_source=wechat_sessio">解决vscode在macos Catalina上配置C&#x2F;C++环境及调试问题</a></p>
<p>最后附上自己配置完成后c_cpp_properties.json、tasks.json、launch.json的文件信息。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;configurations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Mac&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;includePath&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;$&#123;workspaceFolder&#125;/**&quot;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;defines&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;macFrameworkPath&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX.sdk/System/Library/Frameworks&quot;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;compilerPath&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/usr/bin/clang&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;cStandard&quot;</span><span class="punctuation">:</span> <span class="string">&quot;c11&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;cppStandard&quot;</span><span class="punctuation">:</span> <span class="string">&quot;c++17&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;intelliSenseMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;clang-x64&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="number">4</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;tasks&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;label&quot;</span><span class="punctuation">:</span> <span class="string">&quot;c++&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;command&quot;</span><span class="punctuation">:</span> <span class="string">&quot;g++&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;shell&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;-g&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;$&#123;file&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;-std=c++17&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;-o&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="string">&quot;$&#123;fileBasenameNoExtension&#125;.out&quot;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;presentation&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;echo&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;reveal&quot;</span><span class="punctuation">:</span> <span class="string">&quot;always&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;focus&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;panel&quot;</span><span class="punctuation">:</span> <span class="string">&quot;shared&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;group&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;kind&quot;</span><span class="punctuation">:</span> <span class="string">&quot;build&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;isDefault&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.2.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;configurations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;(lldb) Launch&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;preLaunchTask&quot;</span><span class="punctuation">:</span> <span class="string">&quot;c++&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;lldb&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;request&quot;</span><span class="punctuation">:</span> <span class="string">&quot;launch&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;program&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$&#123;fileDirname&#125;/$&#123;fileBasenameNoExtension&#125;.out&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;args&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;cwd&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$&#123;workspaceFolder&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/04/12/%E7%AE%80%E5%8D%95%E4%B8%9A%E5%8A%A1%E5%9C%BA%E6%99%AF%E4%B8%8B%E7%9A%84%E5%AD%97%E7%AC%A6%E8%AF%86%E5%88%AB%E7%AE%97%E6%B3%95%E5%BA%94%E7%94%A8/">简单业务场景下的字符识别算法应用</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-04-12</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/%E7%AE%97%E6%B3%95/">算法</a></span><div class="content"><h1 id="ocr"><a href="#ocr" class="headerlink" title="ocr"></a>ocr</h1><p>光学字符识别（ optical character recognition 简称OCR）技术目前已经十分成熟，并且涉及到的大量图像处理、数学知识太过复杂，<br>这里只针对简单业务场景下的数字或者字母（涉及样本数量较少）识别，介绍一些简单但是巧妙的算法。</p>
<h1 id="编辑距离算法"><a href="#编辑距离算法" class="headerlink" title="编辑距离算法"></a>编辑距离算法</h1><p>首先把所有的笔画定义了个8个方向，然后便可以将字符的笔画分解成一个样本字符串。接着当我们在触摸屏上画出一个字符时，也将它分解成8个方向构成的字符串，<br>最后利用编辑距离算法与样本字符串进行比较，就能判断出和不同字符样本的近似度，最小差值对应的字符便是我们所要的结果。</p>
<p><img src="/images/CharacterRecognition/example.png" alt="处理模型" title="处理模型"></p>
<h1 id="欧式距离算法"><a href="#欧式距离算法" class="headerlink" title="欧式距离算法"></a>欧式距离算法</h1><p>首先根据图片提取特征值，比如将一张 400 * 400 的图片分成 5 * 5 份， 也就是25个小格子， 我们统计每个小格子内部有多少黑色像素值，就得到了我们的特征数组。<br>接下来，我们只要把待识别的特征数组和样本数组进行欧式距离的计算，找到最小距离对应的数字就是最终的结果。<br>可以利用knn算法提高识别的精确度(KNN的全称是K Nearest Neighbors，意思是K个最近的邻居)。</p>
<p><img src="/images/CharacterRecognition/example2.jpeg" alt="处理模型" title="处理模型"></p>
<p><img src="/images/CharacterRecognition/example3.jpeg" alt="处理模型" title="处理模型"></p>
<h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><p><a target="_blank" rel="noopener" href="https://github.com/xiamengfan/character-recognition">cocos creator的demo实现</a><br><a target="_blank" rel="noopener" href="http://depts.washington.edu/acelab/proj/dollar/index.html">$1 Unistroke Recognizer</a><br><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/80682302?utm_source=qq&utm_medium=social&utm_oi=694972303708016640">编辑距离算法</a><br><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/a08ba241b2aa">knn算法应用的数字识别</a></p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2021/01/30/%E6%B5%85%E8%B0%88JS%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%BE%AA%E7%8E%AF/">浅谈JS的事件循环</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2021-01-30</time><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/JavaScript/">JavaScript</a></span><div class="content"><h1 id="为什么有事件循环"><a href="#为什么有事件循环" class="headerlink" title="为什么有事件循环"></a>为什么有事件循环</h1><p>首先，JS中的同步任务和异步任务是按怎样的顺序去执行，这依赖于事件循环，因为事件循环本质上就是为了协调多线程任务的进行；<br>然而我们要知道，事件循环本身并不是JS引擎负责的工作，JS作为单线程的脚本语言，是没有能力去协调多线程的任务执行顺序的；<br>回想JS最初的作用，其实就是静态网页为了实现和用户交互所引入进来的，通过键盘、鼠标的输入来执行一段代码，而监听这些输入事件，其实是浏览器的行为，而不是JS的；<br>所以这么一看就很明显了，所谓JS的事件循环，其实是JS所嵌入的环境来定义并实现的，而且根据JS所嵌入的环境，具体的实现也不一样，比如浏览器端和Node服务端的差别就很大；<br>这里主要介绍一下，在浏览器端，如何通过事件循环来与多个事件源进行交互；<br>也就是如何协调用户交互（鼠标、键盘）、脚本（如 JavaScript）、渲染（如 HTML DOM、CSS 样式）、网络等行为等事件的执行顺序；<br>（而在Node端，是没有鼠标、键盘等事件，也没有渲染，多了文件I&#x2F;O事件，详情可以查看<a target="_blank" rel="noopener" href="https://nodejs.org/zh-cn/docs/guides/event-loop-timers-and-nexttick/">Node官网</a>）</p>
<h1 id="浏览器包含的进程："><a href="#浏览器包含的进程：" class="headerlink" title="浏览器包含的进程："></a>浏览器包含的进程：</h1><ul>
<li><strong>Browser进程(浏览器的主进程，负责协调、主控，只有一个)：</strong><br>负责浏览器的界面显示，与用户交互，如前进，后退等<br>负责各个页面的管理，创建和销毁其它进程<br>将Rendered进程得到的内存中的Bitmap,绘制到用户界面上<br>网络资源的管理，下载</li>
<li><strong>第三方插件进程：</strong><br>每种类型的插件对应一个进程，仅当使用该插件时才创建。</li>
<li><strong>GPU进程：</strong><br>最多一个，用于3D绘制等。<br>浏览器渲染进程（浏览器内核）（Render进程，内部是多线程的）：<br>默认每个Tab页面一个进程，互不影响。主要作用为：页面渲染，脚本执行，事件处理等<br>在浏览器中打开一个网页相当于新起了一个进程（进程内有自己的多线程）</li>
</ul>
<h1 id="重点是浏览器内核（渲染进程）"><a href="#重点是浏览器内核（渲染进程）" class="headerlink" title="重点是浏览器内核（渲染进程）"></a>重点是浏览器内核（渲染进程）</h1><p>对于普通的前端操作来说，最重要的渲染进程：页面的渲染，JS的执行，事件的循环等都在这个进程内执行;<br>浏览器是多进程的，浏览器的渲染进程是多线程的；</p>
<h2 id="GUI渲染线程"><a href="#GUI渲染线程" class="headerlink" title="GUI渲染线程"></a>GUI渲染线程</h2><p>负责渲染浏览器界面，解析HTML,CSS,构建DOM树和RenderObject树，布局和绘制等。<br>当界面需要重绘或由于某种操作引发回流时，该线程就会执行。<br>注意，GUI渲染线程与JS引擎线程是互斥的，当JS引擎执行时GUI线程会被挂起（相当于冻结了）,GUI更新会被保存在一个队列中等到JS引擎空闲时立即被执行。</p>
<h2 id="JS引擎线程"><a href="#JS引擎线程" class="headerlink" title="JS引擎线程"></a>JS引擎线程</h2><p>也称为JS内核，负责处理JavaScript脚本程序。（例如V8引擎）。<br>JS引擎线程负责解析JavaScript脚本，运行代码。<br>JS引擎一直等待着任务队列中任务的到来，然后加以处理，一个Tab页（render进程）中无论什么时候都只有一个JS线程在运行JS程序。<br>同样注意，GUI渲染线程与JS引擎线程是互斥的，所以如果JS执行的时间过长，这样就会造成页面的渲染不连贯，导致页面渲染加载阻塞。</p>
<h2 id="事件触发线程"><a href="#事件触发线程" class="headerlink" title="事件触发线程"></a>事件触发线程</h2><p>归属于浏览器而不是JS引擎，用来控制事件循环（可以理解成JS引擎自己都忙不过来，需要浏览器另开线程协助）。<br>JS的同步任务都在主线程上执行，形成一个执行栈，主线程之外，事件触发线程管理着一个任务队列，只要异步任务有了运行结果，就在任务队列之中放置一个事件<br>当JS引擎执行代码块如setTimeout时（也可来自浏览器内核的其它线程，如鼠标点击，AJAX异步请求等），会将对应任务添加到事件线程中。<br>当对应的事件符合触发条件被触发时，该线程会把事件添加到待处理队列的队尾，等待JS引擎空闲时再处理。</p>
<p>一旦执行栈中的所有同步任务执行完毕（此时JS引擎空闲），系统就会读取任务队列，将可运行的异步任务添加到可执行栈，开始执行。</p>
<h2 id="定时触发器线程"><a href="#定时触发器线程" class="headerlink" title="定时触发器线程"></a>定时触发器线程</h2><p>传说中的setTimeout和setInterval所在的线程<br>浏览器定时计数器并不是由JavaScript引擎计数的，（因为JavaScript引擎是单线程的，如果处于阻塞线程状态就会影响计时的准确）<br>因此通过单独线程来计时并触发定时（计时完毕后，添加到事件队列中，等待JS引擎空闲后执行）<br>注意，W3C在HTML标准中规定，规定要求setTimeout中低于4ms的时间间隔算为4ms。</p>
<h2 id="异步http请求线程"><a href="#异步http请求线程" class="headerlink" title="异步http请求线程"></a>异步http请求线程</h2><p>在XMLHttpRequest在连接后是通过浏览器新起一个线程请求<br>将检测到状态变更时，如果设置有回调函数，异步线程就产生状态变更事件，将这个回调再放入事件队列中，再由JavaScript引擎执行</p>
<h1 id="总结浏览器的渲染流程"><a href="#总结浏览器的渲染流程" class="headerlink" title="总结浏览器的渲染流程"></a>总结浏览器的渲染流程</h1><p>Browser主进程收到用户请求（输入url），首先需要获取页面内容（通过网络下载资源）,随后将该任务通过RendererHost接口传递给Render渲染进程<br>Render渲染进程的Renderer接口收到消息，简单解释后，交给渲染线程GUI，然后开始渲染<br>GUI渲染线程接收请求，加载网页并渲染网页，这其中可能需要Browser主进程获取资源和需要GPU进程来帮助渲染<br>当然可能会有JS线程操作DOM（这可能会造成回流并重绘）<br>最后Render渲染进程将结果传递给Browser主进程<br>Browser主进程接收到结果并将结果绘制出来</p>
<h1 id="回到浏览器的渲染进程（render进程）"><a href="#回到浏览器的渲染进程（render进程）" class="headerlink" title="回到浏览器的渲染进程（render进程）"></a>回到浏览器的渲染进程（render进程）</h1><p>到此时，已经是属于浏览器页面初次渲染完毕后的事情，接下来，详细介绍JS代码是如何去执行的；</p>
<p>各种浏览器事件同时触发时，肯定有一个先来后到的排队问题。决定这些事件如何排队触发的机制，就是事件循环。这个排队行为以 JavaScript 开发者的角度来看，主要是分成两个队列：</p>
<ul>
<li>一个是 JavaScript 外部的队列。外部的队列主要是浏览器协调的各类事件的队列，标准文件中称之为 Task Queue。下文中为了方便理解统一称为外部队列。</li>
<li>另一个是 JavaScript 内部的队列。这部分主要是 JavaScript 内部执行的任务队列，标准中称之为 Microtask Queue。下文中为了方便理解统一称为内部队列。</li>
</ul>
<h2 id="外部队列"><a href="#外部队列" class="headerlink" title="外部队列"></a>外部队列</h2><p>外部队列（Task Queue），顾名思义就是 JavaScript 外部的事件的队列，这里我们可以先列举一下浏览器中这些外部事件源（Task Source），他们主要有：</p>
<ul>
<li>DOM 操作 (页面渲染)</li>
<li>用户交互 (鼠标、键盘)</li>
<li>网络请求 (Ajax 等)</li>
<li>定时器 (setTimeout 等)</li>
</ul>
<p>可以观察到，这些外部的事件源可能很多，为了方便浏览器厂商优化，HTML 标准中明确指出一个事件循环由一个或多个外部队列，而每一个外部事件源都有一个对应的外部队列。不同事件源的队列可以有不同的优先级（例如在网络事件和用户交互之间，浏览器可以优先处理鼠标行为，从而让用户感觉更加流程）</p>
<h2 id="内部队列"><a href="#内部队列" class="headerlink" title="内部队列"></a>内部队列</h2><p>内部队列（Microtask Queue），即 JavaScript 语言内部的事件队列，在 HTML 标准中，并没有明确规定这个队列的事件源，通常认为有以下几种：</p>
<ul>
<li>Promise 的成功 (.then) 与失败 (.catch)</li>
<li>MutationObserver</li>
</ul>
<h2 id="处理模型"><a href="#处理模型" class="headerlink" title="处理模型"></a>处理模型</h2><p><img src="/images/JSEventLoop/event-loop.jpeg" alt="事件循环处理模型" title="事件循环处理模型"></p>
<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">0</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> fn = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>);</span><br><span class="line">            <span class="title function_">resolve</span>(<span class="number">2</span>);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(value)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">fn</span>();</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">pre</span> <span class="attr">id</span>=<span class="string">&quot;main&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> main = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#main&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> <span class="title function_">callback</span> = (<span class="params">i, fn</span>) =&gt; <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(i)</span></span><br><span class="line"><span class="language-javascript">        main.<span class="property">innerText</span> += <span class="title function_">fn</span>(i);</span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> i = <span class="number">1</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">while</span> (i++ &lt; <span class="number">5</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="built_in">setTimeout</span>(<span class="title function_">callback</span>(i, <span class="function">(<span class="params">i</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> <span class="string">&#x27;\n&#x27;</span> + i + <span class="string">&#x27;&lt;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;))</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">while</span> (i++ &lt; <span class="number">10</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">Promise</span>.<span class="title function_">resolve</span>().<span class="title function_">then</span>(<span class="title function_">callback</span>(i, <span class="function">(<span class="params">i</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> i + <span class="string">&#x27;,&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;))</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i)</span></span><br><span class="line"><span class="language-javascript">    main.<span class="property">innerText</span> += <span class="string">&#x27;[end &#x27;</span> + i + <span class="string">&#x27; ]\n&#x27;</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="title function_">_sleep</span>(<span class="params">time = <span class="number">0</span></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">            <span class="title function_">resolve</span>();</span><br><span class="line">        &#125;, time);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">isLoader</span> = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">await</span> <span class="variable language_">this</span>.<span class="title function_">_sleep</span>();</span><br><span class="line"><span class="comment">// other异步任务</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">isLoader</span> = <span class="literal">false</span>;</span><br></pre></td></tr></table></figure>

<h3 id="Promise-和-async-x2F-await"><a href="#Promise-和-async-x2F-await" class="headerlink" title="Promise 和 async&#x2F;await"></a>Promise 和 async&#x2F;await</h3><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/58428287">Promise 源码分析</a><br><a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2015/04/generator.html">async&#x2F;await 源码分析</a></p>
<p>其实，script 本身就是是一个外部队列事件，先执行所有内部事件，接着执行渲染，再去执行一个外部事件，满足模型的执行流程；</p>
</div><hr></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2013 - 2023 By xiamengfan</div><div class="framework-info"><span>Driven - </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a target="_blank" rel="noopener" href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/lib/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.9.1"></script><script src="/js/fancybox.js?version=1.9.1"></script><script src="/js/sidebar.js?version=1.9.1"></script><script src="/js/copy.js?version=1.9.1"></script><script src="/js/fireworks.js?version=1.9.1"></script><script src="/js/transition.js?version=1.9.1"></script><script src="/js/scroll.js?version=1.9.1"></script><script src="/js/head.js?version=1.9.1"></script><script>if(/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
  $('#top-container').addClass('is-mobile')
}</script></body></html>